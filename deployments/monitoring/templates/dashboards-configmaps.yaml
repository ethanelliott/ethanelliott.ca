{{- $labelKey := default "grafana_dashboard" .Values.dashboardLabelKey -}}
{{- $labelValue := default "1" .Values.dashboardLabelValue -}}
{{- $dashboards := .Files.Glob "dashboards/*.json" -}}
{{- if $dashboards }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "monitoring.fullname" . }}-dashboards
  labels:
    {{- include "monitoring.labels" . | nindent 4 }}
    {{ $labelKey }}: {{ $labelValue | quote }}
data:
{{- range $path, $content := $dashboards }}
  {{ base $path }}: |
{{ $content | indent 4 }}
{{- end }}
{{- end }}
