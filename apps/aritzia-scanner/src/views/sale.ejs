<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= title %> - Aritzia Scanner</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <%- include('partials/nav') %>

    <h1><%= title %></h1>

    <% if (saleItems && saleItems.length > 0) { %>
    <div class="product-grid">
      <% saleItems.forEach(product => { %> <% const link =
      `/product/${product.product_id}/variant/${product.color_id}`; const
      subtext = `${product.color} (${product.length})`; %>
      <div class="product-card">
        <a href="<%= link %>" class="product-image">
          <% if (product.thumbnail_id) { %>
          <img
            src="/api/images/<%= product.thumbnail_id %>"
            alt="<%= product.name %>"
            loading="lazy"
          />
          <% } else { %>
          <span style="color: #999">No Image</span>
          <% } %>
        </a>
        <div class="product-info">
          <a href="<%= link %>" class="product-name"><%= product.name %></a>

          <div class="product-price" style="margin-bottom: 5px">
            <span style="color: #d9534f; font-weight: bold"
              >$<%= product.price %></span
            >
            <span
              style="
                text-decoration: line-through;
                color: #999;
                font-size: 0.9em;
              "
              >$<%= product.list_price %></span
            >
            <span style="color: #d9534f; font-size: 0.8em; margin-left: 5px">
              (<%= Math.round((1 - product.price / product.list_price) * 100)
              %>% OFF)
            </span>
          </div>

          <div
            class="variant-details"
            style="font-size: 0.9em; color: #555; margin-bottom: 5px"
          >
            <%= subtext %>
          </div>

          <% if (product.available_sizes) { %>
          <div style="font-size: 0.8em; color: #555">
            Sizes: <%= JSON.parse(product.available_sizes).join(', ') %>
          </div>
          <% } %>
        </div>
      </div>
      <% }); %>
    </div>
    <% } else { %>
    <p>No items currently on sale.</p>
    <% } %>
  </body>
</html>
